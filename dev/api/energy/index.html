<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Energy &amp; Advanced Macros · OpenBabel.jl</title><meta name="title" content="Energy &amp; Advanced Macros · OpenBabel.jl"/><meta property="og:title" content="Energy &amp; Advanced Macros · OpenBabel.jl"/><meta property="twitter:title" content="Energy &amp; Advanced Macros · OpenBabel.jl"/><meta name="description" content="Documentation for OpenBabel.jl."/><meta property="og:description" content="Documentation for OpenBabel.jl."/><meta property="twitter:description" content="Documentation for OpenBabel.jl."/><meta property="og:url" content="https://MoleculeHub.github.io/OpenBabel.jl/api/energy/"/><meta property="twitter:url" content="https://MoleculeHub.github.io/OpenBabel.jl/api/energy/"/><link rel="canonical" href="https://MoleculeHub.github.io/OpenBabel.jl/api/energy/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">OpenBabel.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../examples/">Examples</a></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../io/">Core I/O Macros</a></li><li><a class="tocitem" href="../properties/">Property &amp; Coordinate Macros</a></li><li><a class="tocitem" href="../filtering/">Filtering &amp; Matching Macros</a></li><li class="is-active"><a class="tocitem" href>Energy &amp; Advanced Macros</a><ul class="internal"><li><a class="tocitem" href="#Energy-Calculations"><span>Energy Calculations</span></a></li><li><a class="tocitem" href="#Structure-Generation"><span>Structure Generation</span></a></li><li><a class="tocitem" href="#Usage-Examples"><span>Usage Examples</span></a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Energy &amp; Advanced Macros</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Energy &amp; Advanced Macros</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MoleculeHub/OpenBabel.jl/blob/main/docs/src/api/energy.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Energy-and-Advanced-Calculation-Macros"><a class="docs-heading-anchor" href="#Energy-and-Advanced-Calculation-Macros">Energy &amp; Advanced Calculation Macros</a><a id="Energy-and-Advanced-Calculation-Macros-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-and-Advanced-Calculation-Macros" title="Permalink"></a></h1><p>These macros perform energy calculations, geometry optimizations, and advanced molecular computations.</p><h2 id="Energy-Calculations"><a class="docs-heading-anchor" href="#Energy-Calculations">Energy Calculations</a><a id="Energy-Calculations-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Calculations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpenBabel.@calculate_energy" href="#OpenBabel.@calculate_energy"><code>OpenBabel.@calculate_energy</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@calculate_energy(expr, forcefield=&quot;MMFF94&quot;)</code></pre><p>Calculate the energy of molecules using a specified forcefield.</p><p><strong>Arguments</strong></p><ul><li><code>expr</code>: The expression to chain with</li><li><code>forcefield</code>: Forcefield to use for energy calculation. Available: &quot;MMFF94&quot; (default), &quot;MMFF94s&quot;, &quot;UFF&quot;, &quot;GAFF&quot;, &quot;Ghemical&quot;</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @calculate_energy(&quot;MMFF94&quot;)
    @output_as(&quot;energies.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/OpenBabel.jl/blob/01e2a79988e59823dbdce1de3083c00bd1c33646/src/macros.jl#L502-L521">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpenBabel.@minimize_energy" href="#OpenBabel.@minimize_energy"><code>OpenBabel.@minimize_energy</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@minimize_energy(expr, forcefield=&quot;MMFF94&quot;)</code></pre><p>Minimize the energy of molecules using a specified forcefield.</p><p><strong>Arguments</strong></p><ul><li><code>expr</code>: The expression to chain with</li><li><code>forcefield</code>: Forcefield to use for energy minimization. Available: &quot;MMFF94&quot; (default), &quot;MMFF94s&quot;, &quot;UFF&quot;, &quot;GAFF&quot;, &quot;Ghemical&quot;</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @minimize_energy(&quot;MMFF94&quot;)
    @output_as(&quot;minimized.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/OpenBabel.jl/blob/01e2a79988e59823dbdce1de3083c00bd1c33646/src/macros.jl#L526-L545">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpenBabel.@add_partial_charges" href="#OpenBabel.@add_partial_charges"><code>OpenBabel.@add_partial_charges</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@add_partial_charges(expr, method=&quot;gasteiger&quot;)</code></pre><p>Add partial charges to molecules using specified method.</p><p><strong>Arguments</strong></p><ul><li><code>expr</code>: The expression to chain with</li><li><code>method</code>: Charge calculation method. Available: &quot;gasteiger&quot; (default), &quot;mmff94&quot;, &quot;qeq&quot;, &quot;eqeq&quot;, &quot;eem&quot;</li></ul><p><strong>Example</strong></p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @add_partial_charges(&quot;gasteiger&quot;)
    @output_as(&quot;charged.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/OpenBabel.jl/blob/01e2a79988e59823dbdce1de3083c00bd1c33646/src/macros.jl#L550-L569">source</a></section></article><h2 id="Structure-Generation"><a class="docs-heading-anchor" href="#Structure-Generation">Structure Generation</a><a id="Structure-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Structure-Generation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpenBabel.@canonicalize" href="#OpenBabel.@canonicalize"><code>OpenBabel.@canonicalize</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@canonicalize(expr)</code></pre><p>Canonicalize the atom order in molecules.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;molecules.sdf&quot;, &quot;sdf&quot;)
    @canonicalize()
    @output_as(&quot;canonical.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/OpenBabel.jl/blob/01e2a79988e59823dbdce1de3083c00bd1c33646/src/macros.jl#L574-L588">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="OpenBabel.@generate_conformers" href="#OpenBabel.@generate_conformers"><code>OpenBabel.@generate_conformers</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@generate_conformers(expr)</code></pre><p>Generate conformers for molecules.</p><p><strong>Example</strong></p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @generate_conformers()
    @output_as(&quot;conformers.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MoleculeHub/OpenBabel.jl/blob/01e2a79988e59823dbdce1de3083c00bd1c33646/src/macros.jl#L593-L608">source</a></section></article><h2 id="Usage-Examples"><a class="docs-heading-anchor" href="#Usage-Examples">Usage Examples</a><a id="Usage-Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Usage-Examples" title="Permalink"></a></h2><h3 id="Energy-Minimization-Workflow"><a class="docs-heading-anchor" href="#Energy-Minimization-Workflow">Energy Minimization Workflow</a><a id="Energy-Minimization-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Minimization-Workflow" title="Permalink"></a></h3><p>Optimize molecular geometries using different forcefields:</p><pre><code class="language-julia hljs"># MMFF94 forcefield (default)
@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @minimize_energy(&quot;MMFF94&quot;)
    @calculate_energy(&quot;MMFF94&quot;)
    @output_as(&quot;optimized.sdf&quot;, &quot;sdf&quot;)
    @execute
end

# UFF forcefield
@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;med&quot;)
    @minimize_energy(&quot;UFF&quot;)
    @output_as(&quot;uff_optimized.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre><h3 id="Available-Forcefields"><a class="docs-heading-anchor" href="#Available-Forcefields">Available Forcefields</a><a id="Available-Forcefields-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Forcefields" title="Permalink"></a></h3><table><tr><th style="text-align: right">Forcefield</th><th style="text-align: right">Description</th><th style="text-align: right">Best for</th></tr><tr><td style="text-align: right"><code>MMFF94</code></td><td style="text-align: right">Merck Molecular Force Field</td><td style="text-align: right">General organic molecules</td></tr><tr><td style="text-align: right"><code>MMFF94s</code></td><td style="text-align: right">MMFF94 static</td><td style="text-align: right">Static conformations</td></tr><tr><td style="text-align: right"><code>UFF</code></td><td style="text-align: right">Universal Force Field</td><td style="text-align: right">Broad chemical space</td></tr><tr><td style="text-align: right"><code>GAFF</code></td><td style="text-align: right">General AMBER Force Field</td><td style="text-align: right">Drug-like molecules</td></tr><tr><td style="text-align: right"><code>Ghemical</code></td><td style="text-align: right">Ghemical Force Field</td><td style="text-align: right">Quick calculations</td></tr></table><h3 id="Partial-Charge-Calculation"><a class="docs-heading-anchor" href="#Partial-Charge-Calculation">Partial Charge Calculation</a><a id="Partial-Charge-Calculation-1"></a><a class="docs-heading-anchor-permalink" href="#Partial-Charge-Calculation" title="Permalink"></a></h3><p>Add partial charges using different methods:</p><pre><code class="language-julia hljs"># Gasteiger charges (default)
@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @add_partial_charges(&quot;gasteiger&quot;)
    @output_as(&quot;charged_molecules.sdf&quot;, &quot;sdf&quot;)
    @execute
end

# MMFF94 charges
@chain begin
    @read_file(&quot;molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;fast&quot;)
    @add_partial_charges(&quot;mmff94&quot;)
    @output_as(&quot;mmff_charges.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre><h3 id="Available-Charge-Methods"><a class="docs-heading-anchor" href="#Available-Charge-Methods">Available Charge Methods</a><a id="Available-Charge-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Charge-Methods" title="Permalink"></a></h3><table><tr><th style="text-align: right">Method</th><th style="text-align: right">Description</th><th style="text-align: right">Accuracy</th><th style="text-align: right">Speed</th></tr><tr><td style="text-align: right"><code>gasteiger</code></td><td style="text-align: right">Gasteiger-Marsili</td><td style="text-align: right">Medium</td><td style="text-align: right">Fast</td></tr><tr><td style="text-align: right"><code>mmff94</code></td><td style="text-align: right">MMFF94 charges</td><td style="text-align: right">High</td><td style="text-align: right">Medium</td></tr><tr><td style="text-align: right"><code>qeq</code></td><td style="text-align: right">QEq charges</td><td style="text-align: right">Medium</td><td style="text-align: right">Fast</td></tr><tr><td style="text-align: right"><code>eqeq</code></td><td style="text-align: right">EQEq charges</td><td style="text-align: right">Medium</td><td style="text-align: right">Fast</td></tr><tr><td style="text-align: right"><code>eem</code></td><td style="text-align: right">Electronegativity Equalization</td><td style="text-align: right">Medium</td><td style="text-align: right">Medium</td></tr></table><h3 id="Conformer-Generation"><a class="docs-heading-anchor" href="#Conformer-Generation">Conformer Generation</a><a id="Conformer-Generation-1"></a><a class="docs-heading-anchor-permalink" href="#Conformer-Generation" title="Permalink"></a></h3><p>Generate multiple conformations:</p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;flexible_molecules.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;med&quot;)
    @generate_conformers()
    @minimize_energy(&quot;MMFF94&quot;)
    @output_as(&quot;conformers.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre><h3 id="Complete-Energy-Workflow"><a class="docs-heading-anchor" href="#Complete-Energy-Workflow">Complete Energy Workflow</a><a id="Complete-Energy-Workflow-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Energy-Workflow" title="Permalink"></a></h3><p>Comprehensive energy calculation pipeline:</p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;compounds.smi&quot;, &quot;smi&quot;)
    @gen_3D_coords(&quot;slow&quot;)           # High-quality 3D structures
    @canonicalize()                  # Standardize representation
    @minimize_energy(&quot;MMFF94&quot;)       # Optimize geometry
    @add_partial_charges(&quot;mmff94&quot;)   # Add partial charges
    @calculate_energy(&quot;MMFF94&quot;)      # Calculate final energy
    @add_properties([&quot;MW&quot;, &quot;logP&quot;])  # Add additional properties
    @sort_by(&quot;Energy&quot;)               # Sort by energy
    @output_as(&quot;energy_ranked.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre><h3 id="Drug-Discovery-Pipeline"><a class="docs-heading-anchor" href="#Drug-Discovery-Pipeline">Drug Discovery Pipeline</a><a id="Drug-Discovery-Pipeline-1"></a><a class="docs-heading-anchor-permalink" href="#Drug-Discovery-Pipeline" title="Permalink"></a></h3><p>Typical computational chemistry workflow for drug discovery:</p><pre><code class="language-julia hljs">@chain begin
    @read_file(&quot;drug_candidates.smi&quot;, &quot;smi&quot;)
    @ignore_bad_molecules()          # Skip invalid structures
    @gen_3D_coords(&quot;med&quot;)            # Generate 3D coordinates
    @minimize_energy(&quot;MMFF94&quot;)       # Energy minimization
    @add_partial_charges(&quot;gasteiger&quot;) # Add charges
    @add_properties([&quot;MW&quot;, &quot;logP&quot;, &quot;TPSA&quot;, &quot;HBD&quot;, &quot;HBA&quot;, &quot;rotors&quot;])
    @match_smarts_string(&quot;[!Pb;!Hg;!As]&quot;)  # Remove toxic elements
    @sort_by_reverse(&quot;logP&quot;)         # Rank by lipophilicity
    @output_as(&quot;optimized_candidates.sdf&quot;, &quot;sdf&quot;)
    @execute
end</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../filtering/">« Filtering &amp; Matching Macros</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Sunday 14 September 2025 23:26">Sunday 14 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
